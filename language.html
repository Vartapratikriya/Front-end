<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />
    <title>Vartapratikriya: Insights</title>
    <meta content="" name="description" />
    <meta content="" name="keywords" />

    <!-- Favicons -->
    <link href="./assets/img/vartalogo.png" rel="icon" />
    <link href="./assets/img/vartalogo.jpg" rel="apple-touch-icon" />

    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />

    <!-- Bootstrap CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Add Swiper.js library -->
    <link
      rel="stylesheet"
      href="https://unpkg.com/swiper/swiper-bundle.min.css"
    />
    <script src="https://unpkg.com/swiper/swiper-bundle.min.js"></script>

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Roboto:300,300i,400,400i,500,500i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
      rel="stylesheet"
    />
    <!-- Vendor CSS Files -->
    <link href="assets/vendor/aos/aos.css" rel="stylesheet" />
    <link
      href="assets/vendor/bootstrap/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="assets/vendor/bootstrap-icons/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet" />
    <link
      href="assets/vendor/glightbox/css/glightbox.min.css"
      rel="stylesheet"
    />
    <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet" />

    <!-- Template Main CSS File -->
    <link href="./assets/css/style.css" rel="stylesheet" />
    <link href="./assets/css/trending.css" rel="stylesheet" />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/billboard.js/dist/billboard.min.css"
    />
    <link
      rel="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"
      type="text/css"
    />
    <script src="./assets/js/insights.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/billboard.js/dist/billboard.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/1.0.1/Chart.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/owl.carousel.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.1.1/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.1.1/helpers.esm.min.js"></script>
  </head>
  <body id="modals-here" class="scroll-smooth">
    <!-- ======= Header ======= -->
    <header id="header" class="d-flex align-items-center">
      <div class="container d-flex align-items-center justify-content-between">
        <div class="header">
          <a href="index.html" class="logo"><img src="./assets/img/vartalogo.png" alt=""></a>
          <h1 class="logo"><a href="index.html">VartaPratikriya</a></h1>
        </div>
        <!-- Uncomment below if you prefer to use an image logo -->
        <!-- <a href="index.html" class="logo"><img src="assets/img/logo.png" alt=""></a>-->
        <nav id="navbar" class="navbar">
          <ul>
            <li><a class="nav-link scrollto active" href="language.html">Insights</a></li>
            <li><a class="nav-link scrollto" href="map.html">States</a></li>
            <li><a class="nav-link scrollto" href="index.html#channels">Channels</a></li>
            <li><a class="nav-link scrollto" href="index.html#language">Languages</a></li>
            <li><a class="nav-link scrollto" href="index.html#about">About</a></li>
          </ul>
          <i class="bi bi-list mobile-nav-toggle"></i>
        </nav>
        <!-- .navbar -->
      </div>
    </header>
    <!-- End Header -->
    <main id="main" data-aos="fade-up">
      <!-- ======= Breadcrumbs ======= -->
      <section class="breadcrumbs bg-light">
        <div class="container">
          <div class="d-flex justify-content-between align-items-center">
            <ol>
              <li><a href="index.html">Home</a></li>
              <li>Insights</li>
            </ol>
          </div>
        </div>
      </section>
      <!-- End Breadcrumbs -->

      <div class="container" data-aos="fade-up">
        <div class="row">
          <div class="col-md-6">
              <!-- ======= trending topics Section ======= -->
              <section id="trending-topics" class="d-flex flex-column h-200">
                <div id="top-keywords" class="mt-4 mb-2 mx-4 py-3 my-2 shadow-md rounded-md border border-[#000] border-opacity-100 bg-gray-200 text-[#EEEEEE] lg:h-[75%] lg:mt-6">
                  <h2 class="text-[#FF4560] font-bold mb-4 px-4 py-2 flex flex-row justify-center">Article by categories<button id="trendingTopics" class="text-success shadow-lg rounded-full focus:outline-none">
                      <i class="fas fa-info-circle fa-xs text-[#ff4560] p-1"></i>
                  </button></h2>
                  <div id="chart" class="w-full flex justify-center items-center" style="min-height: 365px">
                    <div class="align-items-center">
                      <canvas id="category-chart" aria-label="chart" height="350" width="580"></canvas>
                </div>
              </section> <!-- =======end trending topics Section ======= -->
          </div>

          <div class="col-md-6">
            <section id="popularity-section" class="d-flex flex-column h-100">
              <div class="rounded-xl overflow-hidden bg-gray-200 mx-4 py-3 my-2 border border-[#787A91] border-opacity-100 shadow-md text-[#EEEEEE]">
                <h2 class="text-[#FF4560] flex flex-row justify-center font-bold mb-4 px-4 py-2">
                  Sentiment Index
                  <button id="popularityOverWeek" class="text-black shadow-lg rounded-full focus:outline-none">
                    <i class="fas fa-info-circle fa-xs text-[#ff4560] p-1"></i>
                  </button>
                </h2>
                <div id="chart" class="w-full flex justify-center items-center" style="min-height: 365px">
                  <div class="align-items-center">
                    <canvas id="sentiment-chart" aria-label="chart" height="350" width="580"></canvas>
              </div> <!-- "Pakistan" Popularity Over Week -->
            </section>
          </div>
        </div>
      </div>

      <!-- Recent Fact Check -->
      <div
        class="fact-check-section rounded-xl bg-gray-200 shadow-md mx-4 lg:mx-0 my-2 overflow-hidden border border-[#787A91] border-opacity-100 my-4 text-black"
      >
        <div class="p-4 md:p-8">
          <h2
            class="text-[#FF4560] flex flex-row justify-center font-bold mb-4 px-4 py-3"
          >
            Recent News Articles
            <button
              id="topicFactCheck"
              class="text-black shadow-lg rounded-full focus:outline-none"
            >
              <i class="fas fa-info-circle fa-xs text-[#ff4560] p-1"></i>
            </button>
          </h2>
          <ul
            id="fact-check-list"
            class="fact-check-list text-xs space-y-2 md:space-y-4"
          >
            <!-- Fact checks will be inserted here by JavaScript -->
          </ul>

          <!-- Fact checks will be inserted here by JavaScript -->
          <button class="flex justify-center">
          </button>
        </div>
      </div>
      <!-- Recent Fact Check -->
    </main>
    <!-- End #main -->
    <!-- ======= Footer ======= -->
    <footer id="footer">
      <div class="footer-top">
        <div class="container">
          <div class="row">
            <div class="col-lg-3 col-md-6 footer-contact">
              <h3>Vartapratikriya<span>.</span></h3>
              <p>
                1/1, Service Rd, DG Block(Newtown), Action Area I, Newtown,
                Chakpachuria, New Town, West Bengal 700156 <br /><br />
                <strong>Phone:</strong> 033 2324 2050<br />
                <strong>Email:</strong> info@example.com<br />
              </p>
            </div>
            <!--  <div class="col-lg-3 col-md-6 footer-links">
            <h4>Useful Links</h4>
            <ul>
              <li><i class="bx bx-chevron-right"></i> <a href="#">Home</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#states">States</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#channels">Channels</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="trending.html">Trending Topics</a></li>
              <li><i class="bx bx-chevron-right"></i> <a href="#about">About</a></li>
            </ul>
          </div>
 -->
            <div class="col-lg-3 col-md-6 footer-links">
              <h4>Our Social Networks</h4>
              <div class="social-links mt-2">
                <a href="#" class="twitter"><i class="bx bxl-twitter"></i></a>
                <a href="#" class="facebook"><i class="bx bxl-facebook"></i></a>
                <a href="#" class="instagram"
                  ><i class="bx bxl-instagram"></i
                ></a>
                <a href="#" class="google-plus"><i class="bx bxl-skype"></i></a>
                <a href="#" class="linkedin"><i class="bx bxl-linkedin"></i></a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="container py-4">
        <div class="copyright">
          &copy; Copyright <strong><span>Vartapratikriya</span></strong
          >. All Rights Reserved
        </div>
      </div>
    </footer>
    <!-- End Footer -->

    <div id="preloader"></div>
    <a
      href="#"
      class="back-to-top d-flex align-items-center justify-content-center"
      ><i class="bi bi-arrow-up-short"></i
    ></a>

    <!-- Vendor JS Files -->
    <script src="assets/vendor/purecounter/purecounter_vanilla.js"></script>
    <script src="assets/vendor/aos/aos.js"></script>
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
    <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
    <script src="assets/vendor/waypoints/noframework.waypoints.js"></script>
    <script src="assets/vendor/php-email-form/validate.js"></script>

    <!-- Template Main JS File -->
    <script src="assets/js/main.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const mobileMenuButton = document.getElementById("mobileMenuButton");
        const mobileMenu = document.getElementById("mobileMenu");
        const searchInput = document.getElementById("search-input");
        mobileMenuButton.addEventListener("click", function () {
          mobileMenu.classList.toggle("hidden");
        });

        function collapseMobileMenu() {
          mobileMenu.classList.add("hidden");
        }

        searchInput.addEventListener("click", function (event) {
          event.stopPropagation();
          if (!mobileMenu.classList.contains("hidden")) {
            collapseMobileMenu();
          }
        });
      });
    </script>
    <script>
      function createModalWithText(triggerElementId, text) {
        var modalId = triggerElementId + "Modal";

        // Create the modal
        var modalHTML = `
      <div id="${modalId}" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center  backdrop-filter backdrop-blur-lg  border-slate-50/[0.06] supports-backdrop-blur:bg-white/60 bg-transparent ">
          <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50 "></div>

          <div class="modal-container w-11/12 md:max-w-md mx-auto rounded-lg shadow-lg z-50 overflow-y-auto backdrop-filter backdrop-blur-lg supports-backdrop-blur:bg-white/60 bg-transparent text-white border-slate-400 border-2">
              <div class="modal-close absolute top-0 right-0 cursor-pointer flex flex-col items-center mt-4 mr-4 text-white text-sm z-50">
                  <svg class="fill-current text-white" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18">
                      <path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"></path>
                  </svg>

              </div>

              <div class="modal-content py-4 text-left px-6 ">
                  <div class="flex justify-between items-center pb-3">
                      <!-- Close button moved here -->
                  </div>
                  <p>${text}</p>
              </div>
          </div>
      </div>
  `;

        // Append the modal to the body
        document.body.insertAdjacentHTML("beforeend", modalHTML);

        var triggerElement = document.getElementById(triggerElementId);
        var modalElement = document.getElementById(modalId);
        var modalOverlayElement = modalElement.querySelector(".modal-overlay");

        // Attach click event to the trigger element
        triggerElement.addEventListener("click", function () {
          toggleModal(modalElement);
        });

        // Attach click event to the modal close elements
        var closeElements = modalElement.getElementsByClassName("modal-close");
        for (var i = 0; i < closeElements.length; i++) {
          closeElements[i].addEventListener("click", function () {
            toggleModal(modalElement);
          });
        }

        modalOverlayElement.addEventListener("click", function () {
          toggleModal(modalElement);
        });
      }

      function toggleModal(modal) {
        modal.classList.toggle("opacity-0");
        modal.classList.toggle("pointer-events-none");
        document.body.classList.toggle("modal-active");
      }

      document.onkeydown = function (evt) {
        evt = evt || window.event;
        var isEscape = false;
        if ("key" in evt) {
          isEscape = evt.key === "Escape" || evt.key === "Esc";
        } else {
          isEscape = evt.keyCode === 27;
        }
        if (isEscape && document.body.classList.contains("modal-active")) {
          var modals = document.getElementsByClassName("modal");
          for (var i = 0; i < modals.length; i++) {
            if (!modals[i].classList.contains("opacity-0")) {
              toggleModal(modals[i]);
              break;
            }
          }
        }
      };
    </script>
    <script>
      // Wait for the DOM to load
      document.addEventListener("DOMContentLoaded", function () {
        // Get the search input field and search results container
        const searchInput = document.getElementById("search-input");
        const searchResults = document.getElementById("search-results");

        let debounceTimer; // Variable to hold the debounce timer

        // Attach an event listener to the search input field
        searchInput.addEventListener("input", function () {
          // Clear the previous debounce timer
          clearTimeout(debounceTimer);

          // Set a new debounce timer with the delay
          debounceTimer = setTimeout(() => {
            // Get the search query
            const query = searchInput.value.trim();

            // Clear the search results container
            searchResults.innerHTML = "";

            // Make an AJAX request to fetch the search results
            if (query.length > 0) {
              fetch("/check_channel/", {
                method: "POST",
                headers: {
                  "Content-Type": "application/x-www-form-urlencoded",
                  "X-Requested-With": "XMLHttpRequest",
                  "X-CSRFToken":
                    "pP48IyUPgeAzLKcCV6bxXWn1h8ZcMjf9SwySS5kOA3C1Zp5OI7T2PtozoShlamBk", // Include the CSRF token here
                },
                body: "search=" + encodeURIComponent(query),
              })
                .then((response) => response.json())
                .then((data) => {
                  // Process the search results
                  if (data.results && data.results.length > 0) {
                    // Create a dropdown menu for the search results
                    const dropdownMenu = document.createElement("ul");
                    dropdownMenu.classList.add("dropdown-menu");

                    // Sort the results based on maximum video count
                    data.results.sort((a, b) => {
                      const aMaxCount = Math.max(
                        ...a.topics.map((topic) => topic.video_count)
                      );
                      const bMaxCount = Math.max(
                        ...b.topics.map((topic) => topic.video_count)
                      );
                      return bMaxCount - aMaxCount;
                    });

                    // Loop through the results and create dropdown items
                    for (const result of data.results) {
                      if (result.name && result.slug) {
                        // Create a dropdown item for a news channel
                        const channelItem = document.createElement("li");
                        const channelLink = document.createElement("a");
                        channelLink.href = "/channel/" + result.slug + "/";
                        channelLink.innerHTML = `
                      <img src="${result.logo}" alt="${result.name}" class="logo">
                      <span class="channel-name">${result.name}</span>
                    `;
                        channelLink.appendChild(channelItem);
                        dropdownMenu.appendChild(channelLink);
                      }

                      // Sort the topics based on video count
                      result.topics.sort(
                        (a, b) => b.video_count - a.video_count
                      );

                      // Loop through the topics and create dropdown items
                      for (const topic of result.topics) {
                        const topicItem = document.createElement("li");
                        const topicLink = document.createElement("a");
                        topicLink.href =
                          "/topic/" + encodeURIComponent(topic.topic) + "/";
                        topicLink.innerHTML = `
                      #${topic.topic}
                      <div class="px-1"></div>
                      <div class="inline-flex items-center rounded-lg bg-[#FF4560] opacity-80 px-2 py-1 text-xs font-medium">
                        ${topic.video_count}
                      </div>
                    `;
                        topicLink.appendChild(topicItem);
                        dropdownMenu.appendChild(topicLink);
                      }
                    }

                    // Append the dropdown menu to the search results container
                    searchResults.appendChild(dropdownMenu);

                    // Show the search results container
                    searchResults.style.display = "block";
                  } else {
                    // Create a "No results found" message
                    const noResultsMessage = document.createElement("div");
                    noResultsMessage.textContent = "No results found ðŸ˜”";
                    noResultsMessage.classList.add("text-white");

                    searchResults.appendChild(noResultsMessage);

                    // Show the search results container
                    searchResults.style.display = "block";
                  }
                })
                .catch((error) => {
                  console.error("Error:", error);
                });
            } else {
              // Hide the search results container if the query is empty
              searchResults.style.display = "none";
            }
          }, 300); // Set the debounce delay to 300 milliseconds
        });
      });
    </script>
    <script>
      const factCheckList = document.getElementById("fact-check-list");

      fetch("/fact-check-view/?search_term=Pakistan")
        .then((response) => response.json())
        .then((data) => {
          const factChecks = data.fact_checks;

          if (factChecks.length === 0) {
            factCheckList.innerHTML =
              "<p>No enough fact checks available on this topic.</p>";
          } else {
            for (let factCheck of factChecks) {
              fetch(
                `/fact-check-proxy?url=${encodeURIComponent(
                  factCheck.claimReview[0].url
                )}`
              )
                .then((response) => response.json())
                .then((data) => {
                  const imageUrl =
                    data.image_url || "/static/images/foogymedia_logo.png";

                  const listItem = `
                              <li class="fact-check-item rounded-lg shadow-md mb-2 flex flex-col lg:flex-row">
                                  <img src="${imageUrl}" class="w-96 object-cover rounded-lg flex-grow-0 flex-shrink-0 justify-center lg:w-[20%]  lg:mr-4 h-28 rounded-lg" alt="${
                    factCheck.claimReview[0].publisher.site
                  }">
                                  <div class="flex flex-col flex-grow">
                                      <h3 class="text-sm font-semibold my-2 hover:text-[#FF4560]"><a href="${
                                        factCheck.claimReview[0].url
                                      }">${factCheck.text}</a></h3>
                                      <p class="text-gray-300 text-xs mb-2">Claim Date: ${factCheck.claimDate.slice(
                                        0,
                                        10
                                      )}</p>
                                      <p class="text-xs lg:text-[10px] mb-2">Claimant: ${
                                        factCheck.claimant
                                      }</p>
                                      <p class="text-xs lg:text-sm display-font mb-2"><strong>Rating:</strong> ${
                                        factCheck.claimReview[0].textualRating
                                      }</p>
                                  </div>
                              </li>
                          `;

                  factCheckList.innerHTML += listItem;
                })
                .catch((error) => console.error("Error:", error));
            }
          }
        })
        .catch((error) => console.error("Error:", error));
    </script>
    <script>
      var options = {
        chart: {
          type: "area",
          foreColor: "#ffffff",
          zoom: {
            enabled: false,
          },
          toolbar: {
            show: false,
          },
          theme: {
            mode: "dark",
          },
          height: 350,
        },

        dataLabels: {
          enabled: false,
        },
        stroke: {
          curve: "smooth",
          width: 2,
        },
        series: [
          {
            name: "Topic Popularity",
            data: [45, 33, 38, 72, 138, 103, 0], // Django will replace the placeholder with actual data
          },
        ],
        xaxis: {
          categories: [
            "Sep 07",
            "Sep 08",
            "Sep 09",
            "Sep 10",
            "Sep 11",
            "Sep 12",
            "Sep 13",
          ], // Django will replace with actual data
          labels: {
            style: {
              colors: "#f9fafb",
            },
          },
        },
        yaxis: {
          labels: {
            style: {
              colors: "#f9fafb",
            },
          },
        },
        grid: {
          borderColor: "#4A5568",
        },
        fill: {
          type: "gradient",
          gradient: {
            shadeIntensity: 1,
            opacityFrom: 0.7,
            opacityTo: 0.5,
            stops: [0, 90, 100],
          },
        },
      };

      var chart = new ApexCharts(document.querySelector("#chart"), options);

      chart.render();
    </script>
    <script>
      const topic = "Pakistan";
      const encodedTopic = encodeURIComponent(topic);
      let offset = 0;
      const limit = 4;

      function fetchBulletins() {
        const url = `/bulletins/?topic=${encodedTopic}&limit=${limit}&offset=${offset}`;

        fetch(url)
          .then((response) => response.json())
          .then((data) => {
            const bulletinsData = data.bulletins;
            const totalBulletins = data.total_bulletins;

            let bulletinsDiv = document.getElementById("bulletins");

            for (let bulletin of bulletinsData) {
              let bulletinCard = document.createElement("ul");
              bulletinCard.classList.add(
                "bulletin-card",
                "p-4",
                "border-l",
                "border-gray-300"
              );

              let date = new Date(bulletin.first_video_timestamp);
              let formattedDate = `${date.getHours()}:${(
                "0" + date.getMinutes()
              ).slice(-2)} ${date.getDate()} ${date.toLocaleString("default", {
                month: "long",
              })} ${date.getFullYear()}`;

              let liElement = document.createElement("li");
              liElement.classList.add("ml-4", "relative");

              let absoluteElement = document.createElement("div");
              absoluteElement.classList.add(
                "absolute",
                "w-3",
                "h-3",
                "bg-gray-300",
                "rounded-full",
                "-ml-[38px]",
                "lg:border",
                "border-white",
                "dark:border-gray-900"
              );
              liElement.appendChild(absoluteElement);

              let timestampDiv = document.createElement("div");
              timestampDiv.classList.add(
                "timestamp",
                "text-[11px]",
                "font-bold",
                "text-gray-400"
              );
              timestampDiv.textContent = formattedDate;
              liElement.appendChild(timestampDiv);

              let headlineDiv = document.createElement("div");
              headlineDiv.classList.add(
                "headline",
                "text-gray-200",
                "text-[14px]",
                "lg:text-sm"
              );
              headlineDiv.textContent = bulletin.headline;
              liElement.appendChild(headlineDiv);

              bulletinCard.appendChild(liElement);
              bulletinsDiv.appendChild(bulletinCard);
            }

            const loadMoreBtn = document.getElementById("loadMoreBtn");
            if (offset + limit < totalBulletins) {
              loadMoreBtn.style.display = "block";
              loadMoreBtn.addEventListener("click", loadMoreBulletins);
            } else {
              loadMoreBtn.style.display = "none";
            }
          });
      }

      function loadMoreBulletins() {
        offset += limit;
        fetchBulletins();
      }

      window.onload = fetchBulletins;
    </script>

    <script>
      function downloadElementAsImage(elementId, filename) {
        // Specify background color for the captured element
        var backgroundColor = "#1A232F";
        var element = document.getElementById(elementId);

        // Exclude elements with a specific class from the captured element
        var excludeElements = element.getElementsByClassName(
          "exclude-from-download"
        );
        for (var i = 0; i < excludeElements.length; i++) {
          excludeElements[i].style.display = "none";
        }

        // Store the original legend style
        var originalLegendStyle = null; // Default value when the legend element is not found
        var legendElement = element.querySelector(".apexcharts-legend-text");
        if (legendElement) {
          originalLegendStyle = window.getComputedStyle(legendElement);
        }

        // Use dom-to-image to capture the specified element
        domtoimage
          .toPng(element, {
            bgcolor: backgroundColor,
            quality: 1, // Set the quality to 1 (highest) for better resolution
            filter: function (node) {
              return node.className !== "exclude-from-download"; // Exclude elements with the "exclude-from-download" class
            },
          })
          .then(function (dataUrl) {
            // Create a new canvas to add the watermark
            var watermarkCanvas = document.createElement("canvas");
            var watermarkCtx = watermarkCanvas.getContext("2d");

            // Create an image from the captured data URL
            var img = new Image();
            img.src = dataUrl;

            // Draw the captured image onto the watermark canvas
            img.onload = function () {
              watermarkCanvas.width = img.width;
              watermarkCanvas.height = img.height;
              watermarkCtx.drawImage(img, 0, 0);

              // Configure watermark text properties
              var watermarkText = "FOGGYMEDIA.IN";
              var fontSize = 18;
              var spacing = 180;
              var angle = -20;
              var opacity = 0.1;
              var color = "rgba(255, 255, 255, " + opacity + ")";
              var fontFamily = "Arial";

              // Set the font properties
              watermarkCtx.font = fontSize + "px " + fontFamily;
              watermarkCtx.fillStyle = color;

              // Rotate the context to apply the desired angle
              watermarkCtx.translate(
                watermarkCanvas.width / 2,
                watermarkCanvas.height / 2
              );
              watermarkCtx.rotate((Math.PI / 180) * angle);
              watermarkCtx.translate(
                -watermarkCanvas.width / 2,
                -watermarkCanvas.height / 2
              );

              // Loop through the canvas and add watermark text
              for (var x = 0; x < watermarkCanvas.width; x += spacing) {
                for (var y = 0; y < watermarkCanvas.height; y += spacing) {
                  watermarkCtx.fillText(watermarkText, x, y);
                }
              }

              // Generate the data URL of the watermarked image
              var watermarkedDataURL = watermarkCanvas.toDataURL();

              // Restore the original legend style if available
              if (legendElement && originalLegendStyle) {
                element.querySelector(".apexcharts-legend-text").style =
                  originalLegendStyle;
              }

              // Create a temporary anchor element
              var link = document.createElement("a");
              link.href = watermarkedDataURL;
              link.download = filename;

              // Simulate a click on the anchor element to trigger the download
              link.click();
            };
          })
          .catch(function (error) {
            console.error("Error:", error);
          });
      }
    </script>
    <script>
      // Initialize Swiper carousel
      var swiper = new Swiper(".swiper-container", {
        slidesPerView: "auto",
        spaceBetween: 20,
        loop: true, // Enable circular infinite scroll

        pagination: {
          el: ".swiper-pagination",
          clickable: true,
        },
      });
    </script>
    <script>
      // Initialize Swiper carousel
      var swiper = new Swiper(".swiper-container", {
        slidesPerView: "auto",
        spaceBetween: 20,
        pagination: {
          el: ".swiper-pagination",
          clickable: true,
        },
      });
    </script>
    <script>
      function createModalWithText(triggerElementId, text) {
        var modalId = triggerElementId + "Modal";

        // Create the modal
        var modalHTML = `
                <div id="${modalId}" class="modal opacity-0 pointer-events-none fixed w-full h-full top-0 left-0 flex items-center justify-center  backdrop-filter backdrop-blur-lg dark:border-slate-50/[0.06] bg-white/100 supports-backdrop-blur:bg-white/60 dark:bg-transparent ">
                    <div class="modal-overlay absolute w-full h-full bg-gray-900 opacity-50 "></div>

                    <div class="modal-container w-11/12 md:max-w-md mx-auto rounded-lg shadow-lg z-50 overflow-y-auto dark:bg-transparent text-white border-slate-400 border-2">
                        <div class="modal-close absolute top-0 right-0 cursor-pointer flex flex-col items-center mt-4 mr-4 text-white text-sm z-50">
                            <svg class="fill-current text-white" xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18">
                                <path d="M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"></path>
                            </svg>

                        </div>

                        <div class="modal-content py-4 text-left px-6">
                            <div class="flex justify-between items-center pb-3">

                            </div>
                            <p>${text}</p>
                        </div>
                    </div>
                </div>
            `;

        // Append the modal to the body
        document.body.insertAdjacentHTML("beforeend", modalHTML);

        var triggerElement = document.getElementById(triggerElementId);
        var modalElement = document.getElementById(modalId);
        var modalOverlayElement = modalElement.querySelector(".modal-overlay");

        // Attach click event to the trigger element
        triggerElement.addEventListener("click", function () {
          toggleModal(modalElement);
        });

        // Attach click event to the modal close elements
        var closeElements = modalElement.getElementsByClassName("modal-close");
        for (var i = 0; i < closeElements.length; i++) {
          closeElements[i].addEventListener("click", function () {
            toggleModal(modalElement);
          });
        }

        modalOverlayElement.addEventListener("click", function () {
          toggleModal(modalElement);
        });
      }

      function toggleModal(modal) {
        modal.classList.toggle("opacity-0");
        modal.classList.toggle("pointer-events-none");
        document.body.classList.toggle("modal-active");
      }

      document.onkeydown = function (evt) {
        evt = evt || window.event;
        var isEscape = false;
        if ("key" in evt) {
          isEscape = evt.key === "Escape" || evt.key === "Esc";
        } else {
          isEscape = evt.keyCode === 27;
        }
        if (isEscape && document.body.classList.contains("modal-active")) {
          var modals = document.getElementsByClassName("modal");
          for (var i = 0; i < modals.length; i++) {
            if (!modals[i].classList.contains("opacity-0")) {
              toggleModal(modals[i]);
              break;
            }
          }
        }
      };

      createModalWithText(
        "topChannels",
        " Stay informed about the most influential sources and their contributions to the topic's coverage."
      );
      createModalWithText(
        "popularityOverWeek",
        "Track the weekly popularity of a news topic with our informative chart, revealing trends and fluctuations in public interest over time."
      );
      createModalWithText(
        "topicFactCheck",
        "Our comprehensive section provides reliable and verified information, debunking misinformation and ensuring accuracy. Get access to credible sources and enhance your understanding of the topic with our up-to-date fact checks."
      );
    </script>
  </body>
</html>
